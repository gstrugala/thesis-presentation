\makeatletter

\pgfdeclareshape{hourglass}{
	\inheritsavedanchors[from=rectangle]
	\inheritanchorborder[from=rectangle]
	\inheritanchor[from=rectangle]{north}
	\inheritanchor[from=rectangle]{north west}
	\inheritanchor[from=rectangle]{north east}
	\inheritanchor[from=rectangle]{center}
	\inheritanchor[from=rectangle]{west}
	\inheritanchor[from=rectangle]{east}
	\inheritanchor[from=rectangle]{mid}
	\inheritanchor[from=rectangle]{mid west}
	\inheritanchor[from=rectangle]{mid east}
	\inheritanchor[from=rectangle]{base}
	\inheritanchor[from=rectangle]{base west}
	\inheritanchor[from=rectangle]{base east}
	\inheritanchor[from=rectangle]{south}
	\inheritanchor[from=rectangle]{south west}
	\inheritanchor[from=rectangle]{south east}
	\backgroundpath{
		% store lower right in xa/ya and upper right in xb/yb
		\southwest \pgf@xa=\pgf@x \pgf@ya=\pgf@y
		\northeast \pgf@xb=\pgf@x \pgf@yb=\pgf@y
		% construct main path
		\pgfpathmoveto{\pgfpoint{\pgf@xa}{\pgf@ya}}
		\pgfpathlineto{\pgfpoint{\pgf@xb}{\pgf@yb}}
		\pgfpathlineto{\pgfpoint{\pgf@xa}{\pgf@yb}}
		\pgfpathlineto{\pgfpoint{\pgf@xb}{\pgf@ya}}
		\pgfpathclose}}

\pgfdeclareshape{compressor}{
	\inheritsavedanchors[from=circle]
	\inheritanchorborder[from=circle]
	\inheritanchor[from=circle]{north}
	\inheritanchor[from=circle]{north west}
	\inheritanchor[from=circle]{north east}
	\inheritanchor[from=circle]{center}
	\inheritanchor[from=circle]{west}
	\inheritanchor[from=circle]{east}
	\inheritanchor[from=circle]{mid}
	\inheritanchor[from=circle]{mid west}
	\inheritanchor[from=circle]{mid east}
	\inheritanchor[from=circle]{base}
	\inheritanchor[from=circle]{base west}
	\inheritanchor[from=circle]{base east}
	\inheritanchor[from=circle]{south}
	\inheritanchor[from=circle]{south west}
	\inheritanchor[from=circle]{south east}
 	\inheritbackgroundpath[from=circle]
	\foregroundpath{
		\centerpoint%
	    \pgf@xc=\pgf@x%
	    \pgf@yc=\pgf@y%
	    \pgfutil@tempdima=\radius%
	    \pgfmathsetlength{\pgf@xb}{\pgfkeysvalueof{/pgf/outer xsep}}%
	    \pgfmathsetlength{\pgf@yb}{\pgfkeysvalueof{/pgf/outer ysep}}%
	    \ifdim\pgf@xb<\pgf@yb%
	      \advance\pgfutil@tempdima by-\pgf@yb%
	    \else%
	      \advance\pgfutil@tempdima by-\pgf@xb%
	    \fi%
	    \pgfpathmoveto{\pgfpointadd{\pgfqpoint{\pgf@xc}{\pgf@yc}}
	    	{\pgfqpoint{0.81915\pgfutil@tempdima}
	    		{-0.5358\pgfutil@tempdima}}}
	    \pgfpathlineto{\pgfpointadd{\pgfqpoint{\pgf@xc}{\pgf@yc}}
	    	{\pgfqpoint{0.25882\pgfutil@tempdima}
	    		{0.96592\pgfutil@tempdima}}}
	    \pgfpathmoveto{\pgfpointadd{\pgfqpoint{\pgf@xc}{\pgf@yc}}
	    	{\pgfqpoint{-0.81915\pgfutil@tempdima}
	    		{-0.57358\pgfutil@tempdima}}}
	    \pgfpathlineto{\pgfpointadd{\pgfqpoint{\pgf@xc}{\pgf@yc}}
	    	{\pgfqpoint{-0.25882\pgfutil@tempdima}
	    		{0.96592\pgfutil@tempdima}}}}}

\pgfdeclareshape{triangle}{
	\inheritsavedanchors[from=rectangle]
	\inheritanchorborder[from=rectangle]
	\inheritanchor[from=rectangle]{north}
	\inheritanchor[from=rectangle]{north west}
	\inheritanchor[from=rectangle]{north east}
	\inheritanchor[from=rectangle]{center}
	\inheritanchor[from=rectangle]{west}
	\inheritanchor[from=rectangle]{east}
	\inheritanchor[from=rectangle]{mid}
	\inheritanchor[from=rectangle]{mid west}
	\inheritanchor[from=rectangle]{mid east}
	\inheritanchor[from=rectangle]{base}
	\inheritanchor[from=rectangle]{base west}
	\inheritanchor[from=rectangle]{base east}
	\inheritanchor[from=rectangle]{south}
	\inheritanchor[from=rectangle]{south west}
	\inheritanchor[from=rectangle]{south east}
	\backgroundpath{
		% store lower right in xa/ya and upper right in xb/yb
		\southwest \pgf@xa=\pgf@x \pgf@ya=\pgf@y
		\northeast \pgf@xb=\pgf@x \pgf@yb=\pgf@y
		% construct main path
		\pgfpathmoveto{\pgfpoint{\pgf@xa}{\pgf@ya}}
		\pgfpathlineto{\pgfpoint{0.5\pgf@xb+0.5\pgf@xa}{\pgf@yb}}
		\pgfpathlineto{\pgfpoint{\pgf@xb}{\pgf@ya}}
		\pgfpathclose}}

\makeatother
